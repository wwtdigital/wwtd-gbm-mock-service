{"openapi":"3.1.0","info":{"title":"ai-advisor-api","version":"1.0.0"},"paths":{"/api/user":{"get":{"tags":["user"],"summary":"Get All Users Route","operationId":"get_all_users_route_api_user_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/User"},"type":"array","title":"Response Get All Users Route Api User Get"}}}}}},"post":{"tags":["user"],"summary":"Create User Route","operationId":"create_user_route_api_user_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/User"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/User"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/user/{user_id}":{"get":{"tags":["user"],"summary":"Get User Route","operationId":"get_user_route_api_user__user_id__get","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/User"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["user"],"summary":"Delete User Route","operationId":"delete_user_route_api_user__user_id__delete","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Delete User Route Api User  User Id  Delete"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/thread":{"post":{"tags":["chat"],"summary":"Create a new thread","description":"This thread endpoint allows you to create a new thread or continue an existing one.\nSteps\n1. TEMP: Get the user_id from the request headers (we will integrate the OAUTH so that the user_id is checked by validating the temp auth token, but might need to consider best way to do this).\n2. If thread_id is provided, get the thread object by thread_id and user_id. Otherwise, create a new thread object with the user_id.\n3. Create a new entry in the entries table using the request payload and the thread_id from step 1\n4. Fetch up to the last 4 Entries in a thread, ordered by created_at, to send to the LLM service.\n5. Send the entries to the LLM service to get a response. (TEMP using a dummy response)\n6. Create a new entry in the entries table with the response from the LLM service.\n7. Return the response entry once confirmed response is in the DB.","operationId":"create_or_continue_thread_api_thread_post","parameters":[{"name":"thread_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Thread Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Item"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Entry"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["chat"],"summary":"Get all threads for a user","description":"Retrieve all threads for a specific user.","operationId":"get_all_user_threads_api_thread_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Thread"},"title":"Response Get All User Threads Api Thread Get"}}}}}}},"/api/thread/{thread_id}":{"post":{"tags":["chat"],"summary":"Chat request to an existing history","description":"This thread endpoint allows you to create a new thread or continue an existing one.\nSteps\n1. TEMP: Get the user_id from the request headers (we will integrate the OAUTH so that the user_id is checked by validating the temp auth token, but might need to consider best way to do this).\n2. If thread_id is provided, get the thread object by thread_id and user_id. Otherwise, create a new thread object with the user_id.\n3. Create a new entry in the entries table using the request payload and the thread_id from step 1\n4. Fetch up to the last 4 Entries in a thread, ordered by created_at, to send to the LLM service.\n5. Send the entries to the LLM service to get a response. (TEMP using a dummy response)\n6. Create a new entry in the entries table with the response from the LLM service.\n7. Return the response entry once confirmed response is in the DB.","operationId":"create_or_continue_thread_api_thread__thread_id__post","parameters":[{"name":"thread_id","in":"path","required":true,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Thread Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Item"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Entry"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["chat"],"summary":"Delete a thread by ID","description":"Delete a thread by its ID.","operationId":"delete_thread_api_thread__thread_id__delete","parameters":[{"name":"thread_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Thread Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"Content":{"properties":{"text":{"type":"string","title":"Text","description":"Text message","default":"hello world","example":"hello gbm world"},"visual":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Visual","description":"dictionary def of visualizations/graphs"},"sources":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Sources","description":"array of sources used","default":[]}},"type":"object","title":"Content","description":"Lowest level representation of a message content"},"Entry":{"properties":{"id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Id","description":"Auto Incrementing ID, managed by DB","example":1},"entry_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Entry Id","description":"Unique Entry ID, managed by DB","example":"123e4567-e89b-12d3-a456-426614174000"},"thread_id":{"type":"string","format":"uuid","title":"Thread Id","description":"ID of the thread this entry belongs to","example":"123e4567-e89b-12d3-a456-426614174000"},"category":{"type":"string","title":"Category","description":"Category of the entry","default":"request","example":"request"},"data":{"$ref":"#/components/schemas/Item"},"created_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Created At","description":"Timestamp of when the entry was created","example":"2023-10-01T12:00:00Z"}},"type":"object","required":["thread_id","data"],"title":"Entry","description":"DTO for a single entry in a thread","example":{"category":"request","created_at":"2023-10-01T12:00:00Z","data":{"content":{"sources":[],"text":"Hi! I need a summary of the most recent data around GBM"},"role":"user"},"entry_id":"123e4567-e89b-12d3-a456-426614174000","id:":1,"thread_id":"123e4567-e89b-12d3-a456-426614174000"}},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"Item":{"properties":{"role":{"type":"string","title":"Role","description":"Role of sender","default":"assistant","example":"assistant"},"content":{"$ref":"#/components/schemas/Content"}},"type":"object","required":["content"],"title":"Item","description":"Item/Universal Message model","example":{"content":{"sources":[],"text":"Hello, I need a summary of the most recent data around GBM"},"role":"user"}},"Thread":{"properties":{"id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Id","description":"Auto Incrementing ID","example":1},"thread_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Thread Id","description":"UUID Thread ID","example":"123e4567-e89b-12d3-a456-426614174000"},"user_id":{"type":"string","title":"User Id","description":"ID of the user who created the thread","example":"user_123"},"created_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Created At","description":"Timestamp of when the thread was created","example":"2023-10-01T12:00:00Z"},"entries":{"items":{"$ref":"#/components/schemas/Entry"},"type":"array","title":"Entries","description":"List of entries in the thread","default":[]}},"type":"object","required":["user_id"],"title":"Thread","description":"DTO for a thread"},"User":{"properties":{"id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Id","description":"Auto Incrementing ID","example":1},"user_id":{"type":"string","title":"User Id","description":"Unique User ID from Cognito","example":"us-east-1_123456789"},"email":{"type":"string","title":"Email","description":"User's email address","example":"myEmail.gbm.com.mx"},"first_name":{"type":"string","title":"First Name","description":"User's first name","example":"John"},"last_name":{"type":"string","title":"Last Name","description":"User's last name","example":"Doe"},"role":{"type":"string","title":"Role","description":"User's role","example":"admin"}},"type":"object","required":["user_id","email","first_name","last_name","role"],"title":"User","description":"Pydantic model for interacting with API requests and responses.","example":{"email":"myEmail.gbm.com.mx","first_name":"Jen","last_name":"Eric","role":"admin","user_id":"us-east-1_123456789"}},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}
 
